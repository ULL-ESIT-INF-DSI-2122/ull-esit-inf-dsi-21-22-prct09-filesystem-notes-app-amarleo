<!DOCTYPE html><html class="default"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>ull-esit-inf-dsi-21-22-prct09-filesystem-notes-app-amarleo</title><meta name="description" content="Documentation for ull-esit-inf-dsi-21-22-prct09-filesystem-notes-app-amarleo"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script async src="assets/search.js" id="search-script"></script></head><body><script>document.body.classList.add(localStorage.getItem("tsd-theme") || "os")</script><header><div class="tsd-page-toolbar"><div class="container"><div class="table-wrap"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption">Search</label><input type="text" id="tsd-search-field"/></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">ull-esit-inf-dsi-21-22-prct09-filesystem-notes-app-amarleo</a></div><div class="table-cell" id="tsd-widgets"><div id="tsd-filter"><a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a><div class="tsd-filter-group"><div class="tsd-select" id="tsd-filter-visibility"><span class="tsd-select-label">All</span><ul class="tsd-select-list"><li data-value="public">Public</li><li data-value="protected">Public/Protected</li><li data-value="private" class="selected">All</li></ul></div> <input type="checkbox" id="tsd-filter-inherited" checked/><label class="tsd-widget" for="tsd-filter-inherited">Inherited</label><input type="checkbox" id="tsd-filter-externals" checked/><label class="tsd-widget" for="tsd-filter-externals">Externals</label></div></div><a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a></div></div></div></div><div class="tsd-page-title"><div class="container"><h1> ull-esit-inf-dsi-21-22-prct09-filesystem-notes-app-amarleo </h1></div></div></header><div class="container container-main"><div class="row"><div class="col-8 col-content"><div class="tsd-panel tsd-typography">
<a href="#práctica-9-aplicación-de-procesamiento-de-notas-de-texto" id="práctica-9-aplicación-de-procesamiento-de-notas-de-texto" style="color: inherit; text-decoration: none;">
  <h1>Práctica 9: Aplicación de procesamiento de notas de texto</h1>
</a>
<p><a href="https://github.com/ULL-ESIT-INF-DSI-2122/ull-esit-inf-dsi-21-22-prct09-filesystem-notes-app-amarleo/actions/workflows/coveralls.yml"><img src="https://github.com/ULL-ESIT-INF-DSI-2122/ull-esit-inf-dsi-21-22-prct09-filesystem-notes-app-amarleo/actions/workflows/coveralls.yml/badge.svg" alt="Coveralls"></a></p>
<p><a href="https://github.com/ULL-ESIT-INF-DSI-2122/ull-esit-inf-dsi-21-22-prct09-filesystem-notes-app-amarleo/actions/workflows/sonarcloud.yml"><img src="https://github.com/ULL-ESIT-INF-DSI-2122/ull-esit-inf-dsi-21-22-prct09-filesystem-notes-app-amarleo/actions/workflows/sonarcloud.yml/badge.svg" alt="Sonar-Cloud"></a></p>
<p><a href="https://github.com/ULL-ESIT-INF-DSI-2122/ull-esit-inf-dsi-21-22-prct09-filesystem-notes-app-amarleo/actions/workflows/nodejs.yml"><img src="https://github.com/ULL-ESIT-INF-DSI-2122/ull-esit-inf-dsi-21-22-prct09-filesystem-notes-app-amarleo/actions/workflows/nodejs.yml/badge.svg" alt="Tests"></a></p>

<a href="#indice" id="indice" style="color: inherit; text-decoration: none;">
  <h2>Indice</h2>
</a>
<ul>
<li><a href="#pr%C3%A1ctica-9-aplicaci%C3%B3n-de-procesamiento-de-notas-de-texto">Práctica 9: Aplicación de procesamiento de notas de texto</a><ul>
<li><a href="#indice">Indice</a></li>
<li><a href="#introducci%C3%B3n">Introducción</a></li>
<li><a href="#tareas-previas">Tareas Previas</a></li>
<li><a href="#desarrollo-de-la-pr%C3%A1ctica">Desarrollo de la Práctica</a><ul>
<li><a href="#testing">Testing</a></li>
<li><a href="#c%C3%B3digo-desarrollado">Código desarrollado</a></li>
</ul>
</li>
<li><a href="#conclusi%C3%B3n">Conclusión</a></li>
</ul>
</li>
</ul>

<a href="#introducción" id="introducción" style="color: inherit; text-decoration: none;">
  <h2>Introducción</h2>
</a>
<p>El presente informe perteneciente a la novena práctica de la asignatura de Desarrollo de Sistemas Informáticos, la cuál tiene como principales objetivos el manejo de ficheros JSON haciendo uso de la API síncrona de Node.js, además de hacer uso de <a href="https://www.npmjs.com/package/yargs">Yargs</a> para la interacción de la aplicación a través de la línea de comandos. Por último, con el objetivo de ilustrar de forma más llamativa los resultados de las operaciones llevadas a cabo por el usuario, se hará uso del paquete <a href="https://www.npmjs.com/package/chalk">Chalk</a>.</p>

<a href="#tareas-previas" id="tareas-previas" style="color: inherit; text-decoration: none;">
  <h2>Tareas Previas</h2>
</a>
<p>Tal y como se comentó en la introducción, se han propuesto dos nuevos paquetes de NPM para poner en práctica durante el desarrollo de esta práctica. Antes de comenzar a desarrollar el código, se ha realizado la instalación de los mismos.</p>
<p>Por otro lado, se han leido y comprobado la documentación propuesta sobre la API síncrona proporcionada por Node.js para trabajar con el sistema de ficheros. El link a este recurso se encuentra a continuación: <a href="https://nodejs.org/dist/latest-v18.x/docs/api/fs.html#synchronous-api">Link</a></p>

<a href="#desarrollo-de-la-práctica" id="desarrollo-de-la-práctica" style="color: inherit; text-decoration: none;">
  <h2>Desarrollo de la Práctica</h2>
</a>
<p>Antes de comenzar a comentar y ejemplificar el resultado de la práctica, se va a proceder a enumerar las ideas principales que se han tenido en cuenta para el desarrollo de la misma.</p>
<p>En primer lugar, teniendo en cuenta lo propuesto para esta práctica, se ideado posibles clases a desarollar. Como es evidente, principalmente se ha creado una clase para las <strong>Notas</strong>. Con ello se consigue determinar las diferentes características exigidas para una nota en el enunciado. En este caso se pide que una nota tenga como mínimo un título, un contenido y un color. Sabiendo esto, se puede intuir que serán los 3 principales atributos de la clase.</p>
<p>Por otro lado se exige que el sistema de ficheros sea para múltiples usuarios, donde cada usuario puede tener un listado de notas. Sabiendo esto, se extrae que, los atributos principales para la clase <strong>Usuario</strong> sean su nombre y un array de objeto Notas.</p>
<p>Los diferentes métodos que se exigen respecto a la obtención, edición, creación y borrado de notas se pondrán en disposición de esta última clase.</p>

<a href="#testing" id="testing" style="color: inherit; text-decoration: none;">
  <h3>Testing</h3>
</a>
<p>Tal y como ha sido de costumbre hasta ahora, en primer lugar se han creado con Mocha y Chai diferentes tests para las clases a desarrollar. No sólo se comprueban que los diferentes setters y getters gestionan los datos de los atributos de forma correcta, sino que también, los métodos tienen un comportamiento adecuado. Para el caso de Notas no se han desarrollado métodos y por tanto los tests obtenidos son únicamente para la gestión de sus atributos.</p>
<p>Por otra parte, para el caso de User si ha sido necesario crear diferentes escenarios y expectativas. Obviando la comprobación de getters y setters, se muestra a continuación algunos de los métodos y cómo han sido testeados: </p>
<pre><code class="language-typescript"><span class="hl-0">  </span><span class="hl-1">describe</span><span class="hl-0">(</span><span class="hl-2">&#39;User Class methods&#39;</span><span class="hl-0">, () </span><span class="hl-3">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-1">describe</span><span class="hl-0">(</span><span class="hl-2">&#39;add Note method&#39;</span><span class="hl-0">, () </span><span class="hl-3">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">      </span><span class="hl-4">user</span><span class="hl-0">.</span><span class="hl-4">notes</span><span class="hl-0"> = [</span><span class="hl-4">blueNote</span><span class="hl-0">];</span><br/><span class="hl-0">      </span><span class="hl-4">user</span><span class="hl-0">.</span><span class="hl-1">addNote</span><span class="hl-0">(</span><span class="hl-4">redNote</span><span class="hl-0">);</span><br/><span class="hl-0">      </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;If it does not exists, it must create a new directory&#39;</span><span class="hl-0">, () </span><span class="hl-3">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">        </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-4">fs</span><span class="hl-0">.</span><span class="hl-1">existsSync</span><span class="hl-0">(</span><span class="hl-2">&#39;./database&#39;</span><span class="hl-0">)).</span><span class="hl-4">to</span><span class="hl-0">.</span><span class="hl-4">be</span><span class="hl-0">.</span><span class="hl-4">true</span><span class="hl-0">;</span><br/><span class="hl-0">      });</span><br/><span class="hl-0">      </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;If it does not exists, it must create a new user directory&#39;</span><span class="hl-0">, () </span><span class="hl-3">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">        </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-4">fs</span><span class="hl-0">.</span><span class="hl-1">existsSync</span><span class="hl-0">(</span><span class="hl-2">&#39;./database/user&#39;</span><span class="hl-0">)).</span><span class="hl-4">to</span><span class="hl-0">.</span><span class="hl-4">be</span><span class="hl-0">.</span><span class="hl-4">true</span><span class="hl-0">;</span><br/><span class="hl-0">      });</span><br/><span class="hl-0">      </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;There should be 2 files&#39;</span><span class="hl-0">, () </span><span class="hl-3">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">        </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-4">fs</span><span class="hl-0">.</span><span class="hl-1">existsSync</span><span class="hl-0">(</span><span class="hl-2">&#39;./database/user/Blue Note.json&#39;</span><span class="hl-0">)).</span><span class="hl-4">to</span><span class="hl-0">.</span><span class="hl-4">be</span><span class="hl-0">.</span><span class="hl-4">true</span><span class="hl-0">;</span><br/><span class="hl-0">        </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-4">fs</span><span class="hl-0">.</span><span class="hl-1">existsSync</span><span class="hl-0">(</span><span class="hl-2">&#39;./database/user/Red Note.json&#39;</span><span class="hl-0">)).</span><span class="hl-4">to</span><span class="hl-0">.</span><span class="hl-4">be</span><span class="hl-0">.</span><span class="hl-4">true</span><span class="hl-0">;</span><br/><span class="hl-0">      });</span><br/><span class="hl-0">    });</span>
</code></pre>
<p>Este ejemplo gestiona el método de añadir una nueva nota a un usuario. Tal y como se puede ver, en un primer momento se efectúa la creación de una nota sobre el user. A continuación, se comprueba que, además de existir los directorios correspondientes a la <strong>database</strong> y al usuario en cuestión, comprueba si existen los dos ficheros que se han setteado al usuario.</p>
<pre><code class="language-typescript"><span class="hl-0">    </span><span class="hl-1">describe</span><span class="hl-0">(</span><span class="hl-2">&#39;edit Note method&#39;</span><span class="hl-0">, () </span><span class="hl-3">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">      </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;Initial content of red note&#39;</span><span class="hl-0">, () </span><span class="hl-3">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">        </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-4">fs</span><span class="hl-0">.</span><span class="hl-1">readFileSync</span><span class="hl-0">(</span><br/><span class="hl-0">            </span><span class="hl-2">&#39;./database/user/Red Note.json&#39;</span><span class="hl-0">, {</span><span class="hl-4">encoding:</span><span class="hl-0"> </span><span class="hl-2">&#39;utf8&#39;</span><span class="hl-0">, </span><span class="hl-4">flag:</span><span class="hl-0"> </span><span class="hl-2">&#39;r&#39;</span><span class="hl-0">}))</span><br/><span class="hl-0">            .</span><span class="hl-4">to</span><span class="hl-0">.</span><span class="hl-4">be</span><span class="hl-0">.</span><span class="hl-1">eql</span><span class="hl-0">(</span><br/><span class="hl-0">                </span><span class="hl-2">&#39;{</span><span class="hl-5">\n\t</span><span class="hl-2">&quot;title&quot;: &quot;Red Note&quot;,&#39;</span><span class="hl-0"> +</span><br/><span class="hl-0">                </span><span class="hl-2">&#39;</span><span class="hl-5">\n\t</span><span class="hl-2">&quot;body&quot;: &quot;This is a red note&quot;,&#39;</span><span class="hl-0"> +</span><br/><span class="hl-0">                </span><span class="hl-2">&#39;</span><span class="hl-5">\n\t</span><span class="hl-2">&quot;color&quot;: &quot;Red&quot;&#39;</span><span class="hl-0"> +</span><br/><span class="hl-0">                </span><span class="hl-2">&#39;</span><span class="hl-5">\n</span><span class="hl-2">}&#39;</span><span class="hl-0">);</span><br/><span class="hl-0">      });</span><br/><span class="hl-0">      </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;Final content of red note&#39;</span><span class="hl-0">, () </span><span class="hl-3">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">        </span><span class="hl-4">user</span><span class="hl-0">.</span><span class="hl-1">editNote</span><span class="hl-0">(</span><span class="hl-4">redNoteEdit</span><span class="hl-0">);</span><br/><span class="hl-0">        </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-4">fs</span><span class="hl-0">.</span><span class="hl-1">readFileSync</span><span class="hl-0">(</span><br/><span class="hl-0">            </span><span class="hl-2">&#39;./database/user/Red Note.json&#39;</span><span class="hl-0">, {</span><span class="hl-4">encoding:</span><span class="hl-0"> </span><span class="hl-2">&#39;utf8&#39;</span><span class="hl-0">, </span><span class="hl-4">flag:</span><span class="hl-0"> </span><span class="hl-2">&#39;r&#39;</span><span class="hl-0">}))</span><br/><span class="hl-0">            .</span><span class="hl-4">to</span><span class="hl-0">.</span><span class="hl-4">be</span><span class="hl-0">.</span><span class="hl-1">eql</span><span class="hl-0">(</span><br/><span class="hl-0">                </span><span class="hl-2">&#39;{</span><span class="hl-5">\n\t</span><span class="hl-2">&quot;title&quot;: &quot;Red Note&quot;,&#39;</span><span class="hl-0"> +</span><br/><span class="hl-0">                </span><span class="hl-2">&#39;</span><span class="hl-5">\n\t</span><span class="hl-2">&quot;body&quot;: &quot;This is a EDIT&quot;,&#39;</span><span class="hl-0"> +</span><br/><span class="hl-0">                </span><span class="hl-2">&#39;</span><span class="hl-5">\n\t</span><span class="hl-2">&quot;color&quot;: &quot;Red&quot;&#39;</span><span class="hl-0"> +</span><br/><span class="hl-0">                </span><span class="hl-2">&#39;</span><span class="hl-5">\n</span><span class="hl-2">}&#39;</span><span class="hl-0">);</span><br/><span class="hl-0">        </span><span class="hl-4">user</span><span class="hl-0">.</span><span class="hl-1">editNote</span><span class="hl-0">(</span><span class="hl-4">redNote</span><span class="hl-0">);</span><br/><span class="hl-0">      });</span><br/><span class="hl-0">    });</span>
</code></pre>
<p>Otro ejemplo es el método <strong>editNote</strong>. Para testearlo, en un primer momento se ha comprobado el estado inicial del fichero Red Note, comprobando además de esta forma de que existe desde un primer momento dentro de la base de datos del usuario. Finalmente, se realiza una edición del fichero, comprobando que se ha editado correctamente.</p>

<a href="#código-desarrollado" id="código-desarrollado" style="color: inherit; text-decoration: none;">
  <h3>Código desarrollado</h3>
</a>
<p>Una vez finalizado el desarrollo de los tests, se ha puesto en marcha a realizar los códigos correspondientes a las clases. En primer lugar, la clase <strong>Note</strong> no tiene mucho más de lo que se ha contado hasta ahora. Sin embargo, el único detalle a destacar de esta clase es que se ha creado un nuevo tipo denominado <strong>noteColor</strong>, junto con su guardián de tipo. Esto será necesario durante el desarrollo del index, para comprobar que el dato introducido por línea de comandos es correcto y se encuentra incluído entre las posibilidades.</p>
<p>Por otro lado, en adición a lo comentado para la clase <strong>User</strong> se encuentran los diferentes métodos para la gestión de notas de texto. A continuación se procede a hacer una serie de comentarios de los mismos: </p>
<pre><code class="language-typescript"><span class="hl-0">  </span><span class="hl-1">addNote</span><span class="hl-0">(</span><span class="hl-4">note</span><span class="hl-0">: </span><span class="hl-4">Note</span><span class="hl-0">) {</span><br/><span class="hl-0">    </span><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-6">databasePath</span><span class="hl-0">: </span><span class="hl-7">string</span><span class="hl-0"> = </span><span class="hl-2">&#39;./database/&#39;</span><span class="hl-0"> + </span><span class="hl-3">this</span><span class="hl-0">.</span><span class="hl-4">_name</span><span class="hl-0">;</span><br/><span class="hl-0">    </span><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-6">jsonPath</span><span class="hl-0">: </span><span class="hl-7">string</span><span class="hl-0"> = </span><span class="hl-4">databasePath</span><span class="hl-0"> + </span><span class="hl-2">&#39;/&#39;</span><span class="hl-0"> + </span><span class="hl-4">note</span><span class="hl-0">.</span><span class="hl-4">title</span><span class="hl-0"> + </span><span class="hl-2">&#39;.json&#39;</span><span class="hl-0">;</span><br/><span class="hl-0">    </span><span class="hl-8">if</span><span class="hl-0"> (!</span><span class="hl-4">fs</span><span class="hl-0">.</span><span class="hl-1">existsSync</span><span class="hl-0">(</span><span class="hl-2">&#39;./database&#39;</span><span class="hl-0">)) {</span><br/><span class="hl-0">      </span><span class="hl-4">fs</span><span class="hl-0">.</span><span class="hl-1">mkdirSync</span><span class="hl-0">(</span><span class="hl-2">&#39;./database&#39;</span><span class="hl-0">);</span><br/><span class="hl-0">      </span><span class="hl-4">console</span><span class="hl-0">.</span><span class="hl-1">log</span><span class="hl-0">(</span><span class="hl-4">chalk</span><span class="hl-0">.</span><span class="hl-4">green</span><span class="hl-0">.</span><span class="hl-1">inverse</span><span class="hl-0">(</span><span class="hl-2">&#39;</span><span class="hl-5">\n</span><span class="hl-2">Database directory created&#39;</span><span class="hl-0">));</span><br/><span class="hl-0">    }</span><br/><span class="hl-0">    </span><span class="hl-8">if</span><span class="hl-0"> (!</span><span class="hl-4">fs</span><span class="hl-0">.</span><span class="hl-1">existsSync</span><span class="hl-0">(</span><span class="hl-4">databasePath</span><span class="hl-0">)) {</span><br/><span class="hl-0">      </span><span class="hl-4">fs</span><span class="hl-0">.</span><span class="hl-1">mkdirSync</span><span class="hl-0">(</span><span class="hl-4">databasePath</span><span class="hl-0">);</span><br/><span class="hl-0">      </span><span class="hl-4">console</span><span class="hl-0">.</span><span class="hl-1">log</span><span class="hl-0">(</span><span class="hl-4">chalk</span><span class="hl-0">.</span><span class="hl-4">green</span><span class="hl-0">.</span><span class="hl-1">inverse</span><span class="hl-0">(</span><br/><span class="hl-0">          </span><span class="hl-2">`</span><span class="hl-5">\n</span><span class="hl-2">Directory created for user </span><span class="hl-3">${</span><span class="hl-3">this</span><span class="hl-9">.</span><span class="hl-4">_name</span><span class="hl-3">}</span><span class="hl-2">`</span><span class="hl-0">));</span><br/><span class="hl-0">    }</span><br/><span class="hl-0">    </span><span class="hl-8">if</span><span class="hl-0"> (</span><span class="hl-4">fs</span><span class="hl-0">.</span><span class="hl-1">existsSync</span><span class="hl-0">(</span><span class="hl-4">jsonPath</span><span class="hl-0">)) {</span><br/><span class="hl-0">      </span><span class="hl-4">console</span><span class="hl-0">.</span><span class="hl-1">log</span><span class="hl-0">(</span><span class="hl-4">chalk</span><span class="hl-0">.</span><span class="hl-4">red</span><span class="hl-0">.</span><span class="hl-1">inverse</span><span class="hl-0">(</span><span class="hl-2">`</span><span class="hl-5">\n</span><span class="hl-2">Error: </span><span class="hl-3">${</span><span class="hl-4">note</span><span class="hl-9">.</span><span class="hl-4">title</span><span class="hl-3">}</span><span class="hl-2"> already exists`</span><span class="hl-0"> +</span><br/><span class="hl-0">        </span><span class="hl-2">` for user </span><span class="hl-3">${</span><span class="hl-3">this</span><span class="hl-9">.</span><span class="hl-4">_name</span><span class="hl-3">}</span><span class="hl-2">`</span><span class="hl-0">));</span><br/><span class="hl-0">    } </span><span class="hl-8">else</span><span class="hl-0"> {</span><br/><span class="hl-0">      </span><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-6">noteContent</span><span class="hl-0">: </span><span class="hl-7">string</span><span class="hl-0"> =</span><br/><span class="hl-0">      </span><span class="hl-2">`{</span><span class="hl-5">\n\t</span><span class="hl-2">&quot;title&quot;: &quot;</span><span class="hl-3">${</span><span class="hl-4">note</span><span class="hl-9">.</span><span class="hl-4">title</span><span class="hl-3">}</span><span class="hl-2">&quot;,`</span><span class="hl-0"> +</span><br/><span class="hl-0">      </span><span class="hl-2">`</span><span class="hl-5">\n\t</span><span class="hl-2">&quot;body&quot;: &quot;</span><span class="hl-3">${</span><span class="hl-4">note</span><span class="hl-9">.</span><span class="hl-4">body</span><span class="hl-3">}</span><span class="hl-2">&quot;,`</span><span class="hl-0"> +</span><br/><span class="hl-0">      </span><span class="hl-2">`</span><span class="hl-5">\n\t</span><span class="hl-2">&quot;color&quot;: &quot;</span><span class="hl-3">${</span><span class="hl-4">note</span><span class="hl-9">.</span><span class="hl-4">color</span><span class="hl-3">}</span><span class="hl-2">&quot;`</span><span class="hl-0"> +</span><br/><span class="hl-0">      </span><span class="hl-2">`</span><span class="hl-5">\n</span><span class="hl-2">}`</span><span class="hl-0">;</span><br/><span class="hl-0">      </span><span class="hl-4">fs</span><span class="hl-0">.</span><span class="hl-1">writeFileSync</span><span class="hl-0">(</span><span class="hl-4">jsonPath</span><span class="hl-0">, </span><span class="hl-4">noteContent</span><span class="hl-0">);</span><br/><span class="hl-0">      </span><span class="hl-3">this</span><span class="hl-0">.</span><span class="hl-4">_notes</span><span class="hl-0">.</span><span class="hl-1">push</span><span class="hl-0">(</span><span class="hl-4">note</span><span class="hl-0">);</span><br/><span class="hl-0">      </span><span class="hl-4">console</span><span class="hl-0">.</span><span class="hl-1">log</span><span class="hl-0">(</span><span class="hl-4">chalk</span><span class="hl-0">.</span><span class="hl-4">green</span><span class="hl-0">.</span><span class="hl-1">inverse</span><span class="hl-0">(</span><span class="hl-2">`</span><span class="hl-5">\n</span><span class="hl-3">${</span><span class="hl-4">note</span><span class="hl-9">.</span><span class="hl-4">title</span><span class="hl-3">}</span><span class="hl-2"> note has been added`</span><span class="hl-0"> +</span><br/><span class="hl-0">        </span><span class="hl-2">` to user </span><span class="hl-3">${</span><span class="hl-3">this</span><span class="hl-9">.</span><span class="hl-4">_name</span><span class="hl-3">}</span><span class="hl-2">`</span><span class="hl-0">));</span><br/><span class="hl-0">    }</span><br/><span class="hl-0">  }</span>
</code></pre>
<p>En primer lugar se encuentra el método <strong>addNote</strong>. Este reciube como parámetro un objeto de tipo Nota. Se realizan una serie de comprobaciones previas a la creación del fichero. En concreto son las siguientes:</p>
<ul>
<li>Si no existe el directorio <strong>./database</strong>, lo crea.</li>
<li>Si no existe un directorio para el usuario en cuestión, lo crea.</li>
<li>Si existe un fichero con el mismo nombre, no se añade.</li>
</ul>
<p>En caso de no existir ningún fichero con dicho nombre, se crea un fichero JSON con su contenido.</p>
<pre><code class="language-typescript"><span class="hl-0">  </span><span class="hl-1">editNote</span><span class="hl-0">(</span><span class="hl-4">note</span><span class="hl-0">: </span><span class="hl-4">Note</span><span class="hl-0">) {</span><br/><span class="hl-0">    </span><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-6">jsonPath</span><span class="hl-0">: </span><span class="hl-7">string</span><span class="hl-0"> = </span><span class="hl-2">&#39;./database/&#39;</span><span class="hl-0"> + </span><span class="hl-3">this</span><span class="hl-0">.</span><span class="hl-4">_name</span><span class="hl-0"> +</span><br/><span class="hl-0">    </span><span class="hl-2">&#39;/&#39;</span><span class="hl-0"> + </span><span class="hl-4">note</span><span class="hl-0">.</span><span class="hl-4">title</span><span class="hl-0"> + </span><span class="hl-2">&#39;.json&#39;</span><span class="hl-0">;</span><br/><span class="hl-0">    </span><span class="hl-8">if</span><span class="hl-0"> (</span><span class="hl-4">fs</span><span class="hl-0">.</span><span class="hl-1">existsSync</span><span class="hl-0">(</span><span class="hl-4">jsonPath</span><span class="hl-0">)) {</span><br/><span class="hl-0">      </span><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-6">noteContent</span><span class="hl-0">: </span><span class="hl-7">string</span><span class="hl-0"> =</span><br/><span class="hl-0">      </span><span class="hl-2">`{</span><span class="hl-5">\n\t</span><span class="hl-2">&quot;title&quot;: &quot;</span><span class="hl-3">${</span><span class="hl-4">note</span><span class="hl-9">.</span><span class="hl-4">title</span><span class="hl-3">}</span><span class="hl-2">&quot;,`</span><span class="hl-0"> +</span><br/><span class="hl-0">      </span><span class="hl-2">`</span><span class="hl-5">\n\t</span><span class="hl-2">&quot;body&quot;: &quot;</span><span class="hl-3">${</span><span class="hl-4">note</span><span class="hl-9">.</span><span class="hl-4">body</span><span class="hl-3">}</span><span class="hl-2">&quot;,`</span><span class="hl-0"> +</span><br/><span class="hl-0">      </span><span class="hl-2">`</span><span class="hl-5">\n\t</span><span class="hl-2">&quot;color&quot;: &quot;</span><span class="hl-3">${</span><span class="hl-4">note</span><span class="hl-9">.</span><span class="hl-4">color</span><span class="hl-3">}</span><span class="hl-2">&quot;`</span><span class="hl-0"> +</span><br/><span class="hl-0">      </span><span class="hl-2">`</span><span class="hl-5">\n</span><span class="hl-2">}`</span><span class="hl-0">;</span><br/><span class="hl-0">      </span><span class="hl-4">fs</span><span class="hl-0">.</span><span class="hl-1">writeFileSync</span><span class="hl-0">(</span><span class="hl-4">jsonPath</span><span class="hl-0">, </span><span class="hl-4">noteContent</span><span class="hl-0">);</span><br/><span class="hl-0">      </span><span class="hl-3">this</span><span class="hl-0">.</span><span class="hl-4">_notes</span><span class="hl-0">.</span><span class="hl-1">push</span><span class="hl-0">(</span><span class="hl-4">note</span><span class="hl-0">);</span><br/><span class="hl-0">      </span><span class="hl-4">console</span><span class="hl-0">.</span><span class="hl-1">log</span><span class="hl-0">(</span><span class="hl-4">chalk</span><span class="hl-0">.</span><span class="hl-4">green</span><span class="hl-0">.</span><span class="hl-1">inverse</span><span class="hl-0">(</span><span class="hl-2">`</span><span class="hl-5">\n</span><span class="hl-3">${</span><span class="hl-4">note</span><span class="hl-9">.</span><span class="hl-4">title</span><span class="hl-3">}</span><span class="hl-2"> note has been updated`</span><span class="hl-0"> +</span><br/><span class="hl-0">        </span><span class="hl-2">` to user </span><span class="hl-3">${</span><span class="hl-3">this</span><span class="hl-9">.</span><span class="hl-4">_name</span><span class="hl-3">}</span><span class="hl-2">`</span><span class="hl-0">));</span><br/><span class="hl-0">    } </span><span class="hl-8">else</span><span class="hl-0"> {</span><br/><span class="hl-0">      </span><span class="hl-4">console</span><span class="hl-0">.</span><span class="hl-1">log</span><span class="hl-0">(</span><span class="hl-4">chalk</span><span class="hl-0">.</span><span class="hl-4">red</span><span class="hl-0">.</span><span class="hl-1">inverse</span><span class="hl-0">(</span><span class="hl-2">`Error: </span><span class="hl-3">${</span><span class="hl-4">note</span><span class="hl-9">.</span><span class="hl-4">title</span><span class="hl-3">}</span><span class="hl-2"> `</span><span class="hl-0"> +</span><br/><span class="hl-0">        </span><span class="hl-2">`does not exists on </span><span class="hl-3">${</span><span class="hl-3">this</span><span class="hl-9">.</span><span class="hl-4">_name</span><span class="hl-3">}</span><span class="hl-2"> database`</span><span class="hl-0">));</span><br/><span class="hl-0">    }</span><br/><span class="hl-0">  }</span>
</code></pre>
<p>Para el método <strong>edit</strong> se ha creado un procedimiento similar a addNote, donde si existe un fichero con el nombre proporcionado, se edita el contenido del mismo.</p>
<pre><code class="language-typescript"><span class="hl-0">  </span><span class="hl-1">removeNote</span><span class="hl-0">(</span><span class="hl-4">note</span><span class="hl-0">: </span><span class="hl-4">Note</span><span class="hl-0">) {</span><br/><span class="hl-0">    </span><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-6">jsonPath</span><span class="hl-0">: </span><span class="hl-7">string</span><span class="hl-0"> = </span><span class="hl-2">&#39;./database/&#39;</span><span class="hl-0"> + </span><span class="hl-3">this</span><span class="hl-0">.</span><span class="hl-4">_name</span><span class="hl-0"> +</span><br/><span class="hl-0">     </span><span class="hl-2">&#39;/&#39;</span><span class="hl-0"> + </span><span class="hl-4">note</span><span class="hl-0">.</span><span class="hl-4">title</span><span class="hl-0"> + </span><span class="hl-2">&#39;.json&#39;</span><span class="hl-0">;</span><br/><span class="hl-0">    </span><span class="hl-8">if</span><span class="hl-0"> (</span><span class="hl-4">fs</span><span class="hl-0">.</span><span class="hl-1">existsSync</span><span class="hl-0">(</span><span class="hl-4">jsonPath</span><span class="hl-0">)) {</span><br/><span class="hl-0">      </span><span class="hl-4">fs</span><span class="hl-0">.</span><span class="hl-1">unlink</span><span class="hl-0">(</span><span class="hl-4">jsonPath</span><span class="hl-0">, (</span><span class="hl-4">err</span><span class="hl-0">) </span><span class="hl-3">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">        </span><span class="hl-8">if</span><span class="hl-0"> (</span><span class="hl-4">err</span><span class="hl-0">) </span><span class="hl-8">throw</span><span class="hl-0"> </span><span class="hl-4">err</span><span class="hl-0">;</span><br/><span class="hl-0">        </span><span class="hl-4">console</span><span class="hl-0">.</span><span class="hl-1">log</span><span class="hl-0">(</span><span class="hl-4">chalk</span><span class="hl-0">.</span><span class="hl-4">green</span><span class="hl-0">.</span><span class="hl-1">inverse</span><span class="hl-0">(</span><span class="hl-2">`</span><span class="hl-5">\n</span><span class="hl-3">${</span><span class="hl-4">jsonPath</span><span class="hl-3">}</span><span class="hl-2"> was deleted`</span><span class="hl-0">));</span><br/><span class="hl-0">      });</span><br/><span class="hl-0">    } </span><span class="hl-8">else</span><span class="hl-0"> {</span><br/><span class="hl-0">      </span><span class="hl-4">console</span><span class="hl-0">.</span><span class="hl-1">log</span><span class="hl-0">(</span><span class="hl-4">chalk</span><span class="hl-0">.</span><span class="hl-4">red</span><span class="hl-0">.</span><span class="hl-1">inverse</span><span class="hl-0">(</span><span class="hl-2">`Error: </span><span class="hl-3">${</span><span class="hl-4">note</span><span class="hl-9">.</span><span class="hl-4">title</span><span class="hl-3">}</span><span class="hl-2"> `</span><span class="hl-0"> +</span><br/><span class="hl-0">        </span><span class="hl-2">`does not exists on </span><span class="hl-3">${</span><span class="hl-3">this</span><span class="hl-9">.</span><span class="hl-4">_name</span><span class="hl-3">}</span><span class="hl-2"> database`</span><span class="hl-0">));</span><br/><span class="hl-0">    }</span><br/><span class="hl-0">  }</span>
</code></pre>
<p>Para el método <strong>removeNote</strong> se comprueba si existe el fichero y, en tal caso, se borra el mismo.</p>
<pre><code class="language-typescript"><span class="hl-0">  </span><span class="hl-1">listAllNotes</span><span class="hl-0">() {</span><br/><span class="hl-0">    </span><span class="hl-4">console</span><span class="hl-0">.</span><span class="hl-1">log</span><span class="hl-0">(</span><span class="hl-2">`</span><span class="hl-5">\n</span><span class="hl-2"> --- </span><span class="hl-3">${</span><span class="hl-3">this</span><span class="hl-9">.</span><span class="hl-4">_name</span><span class="hl-3">}</span><span class="hl-2"> notes ---</span><span class="hl-5">\n</span><span class="hl-2">`</span><span class="hl-0">);</span><br/><span class="hl-0">    </span><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-6">databasePath</span><span class="hl-0">: </span><span class="hl-7">string</span><span class="hl-0"> = </span><span class="hl-2">&#39;./database/&#39;</span><span class="hl-0"> + </span><span class="hl-3">this</span><span class="hl-0">.</span><span class="hl-4">_name</span><span class="hl-0">;</span><br/><span class="hl-0">    </span><span class="hl-4">fs</span><span class="hl-0">.</span><span class="hl-1">readdirSync</span><span class="hl-0">(</span><span class="hl-4">databasePath</span><span class="hl-0">).</span><span class="hl-1">forEach</span><span class="hl-0">((</span><span class="hl-4">file</span><span class="hl-0">: </span><span class="hl-7">string</span><span class="hl-0">) </span><span class="hl-3">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">      </span><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-6">note</span><span class="hl-0"> = </span><span class="hl-3">new</span><span class="hl-0"> </span><span class="hl-1">Note</span><span class="hl-0">(</span><span class="hl-4">file</span><span class="hl-0">);</span><br/><span class="hl-0">      </span><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-6">jsonPath</span><span class="hl-0">: </span><span class="hl-7">string</span><span class="hl-0"> = </span><span class="hl-2">&#39;./database/&#39;</span><span class="hl-0"> + </span><span class="hl-3">this</span><span class="hl-0">.</span><span class="hl-4">_name</span><span class="hl-0"> +</span><br/><span class="hl-0">      </span><span class="hl-2">&#39;/&#39;</span><span class="hl-0"> + </span><span class="hl-4">note</span><span class="hl-0">.</span><span class="hl-4">title</span><span class="hl-0">;</span><br/><span class="hl-0">      </span><span class="hl-3">let</span><span class="hl-0"> </span><span class="hl-4">data</span><span class="hl-0">: </span><span class="hl-7">string</span><span class="hl-0"> = </span><span class="hl-4">fs</span><span class="hl-0">.</span><span class="hl-1">readFileSync</span><span class="hl-0">(</span><span class="hl-4">jsonPath</span><span class="hl-0">,</span><br/><span class="hl-0">          {</span><span class="hl-4">encoding:</span><span class="hl-0"> </span><span class="hl-2">&#39;utf8&#39;</span><span class="hl-0">, </span><span class="hl-4">flag:</span><span class="hl-0"> </span><span class="hl-2">&#39;r&#39;</span><span class="hl-0">});</span><br/><span class="hl-0">      </span><span class="hl-3">let</span><span class="hl-0"> </span><span class="hl-4">dataObject</span><span class="hl-0"> = </span><span class="hl-7">JSON</span><span class="hl-0">.</span><span class="hl-1">parse</span><span class="hl-0">(</span><span class="hl-4">data</span><span class="hl-0">);</span><br/><span class="hl-0">      </span><span class="hl-8">if</span><span class="hl-0"> (</span><span class="hl-4">dataObject</span><span class="hl-0">.</span><span class="hl-4">color</span><span class="hl-0"> === </span><span class="hl-2">&#39;Blue&#39;</span><span class="hl-0">) {</span><br/><span class="hl-0">        </span><span class="hl-4">console</span><span class="hl-0">.</span><span class="hl-1">log</span><span class="hl-0">(</span><span class="hl-4">chalk</span><span class="hl-0">.</span><span class="hl-1">blue</span><span class="hl-0">(</span><span class="hl-4">file</span><span class="hl-0">.</span><span class="hl-1">replace</span><span class="hl-0">(</span><span class="hl-2">&#39;.json&#39;</span><span class="hl-0">, </span><span class="hl-2">&#39;&#39;</span><span class="hl-0">)));</span><br/><span class="hl-0">      }</span><br/><span class="hl-0">      </span><span class="hl-8">if</span><span class="hl-0"> (</span><span class="hl-4">dataObject</span><span class="hl-0">.</span><span class="hl-4">color</span><span class="hl-0"> === </span><span class="hl-2">&#39;Red&#39;</span><span class="hl-0">) {</span><br/><span class="hl-0">        </span><span class="hl-4">console</span><span class="hl-0">.</span><span class="hl-1">log</span><span class="hl-0">(</span><span class="hl-4">chalk</span><span class="hl-0">.</span><span class="hl-1">red</span><span class="hl-0">(</span><span class="hl-4">file</span><span class="hl-0">.</span><span class="hl-1">replace</span><span class="hl-0">(</span><span class="hl-2">&#39;.json&#39;</span><span class="hl-0">, </span><span class="hl-2">&#39;&#39;</span><span class="hl-0">)));</span><br/><span class="hl-0">      }</span><br/><span class="hl-0">      </span><span class="hl-8">if</span><span class="hl-0"> (</span><span class="hl-4">dataObject</span><span class="hl-0">.</span><span class="hl-4">color</span><span class="hl-0"> === </span><span class="hl-2">&#39;Yellow&#39;</span><span class="hl-0">) {</span><br/><span class="hl-0">        </span><span class="hl-4">console</span><span class="hl-0">.</span><span class="hl-1">log</span><span class="hl-0">(</span><span class="hl-4">chalk</span><span class="hl-0">.</span><span class="hl-1">yellow</span><span class="hl-0">(</span><span class="hl-4">file</span><span class="hl-0">.</span><span class="hl-1">replace</span><span class="hl-0">(</span><span class="hl-2">&#39;.json&#39;</span><span class="hl-0">, </span><span class="hl-2">&#39;&#39;</span><span class="hl-0">)));</span><br/><span class="hl-0">      }</span><br/><span class="hl-0">      </span><span class="hl-8">if</span><span class="hl-0"> (</span><span class="hl-4">dataObject</span><span class="hl-0">.</span><span class="hl-4">color</span><span class="hl-0"> === </span><span class="hl-2">&#39;Green&#39;</span><span class="hl-0">) {</span><br/><span class="hl-0">        </span><span class="hl-4">console</span><span class="hl-0">.</span><span class="hl-1">log</span><span class="hl-0">(</span><span class="hl-4">chalk</span><span class="hl-0">.</span><span class="hl-1">green</span><span class="hl-0">(</span><span class="hl-4">file</span><span class="hl-0">.</span><span class="hl-1">replace</span><span class="hl-0">(</span><span class="hl-2">&#39;.json&#39;</span><span class="hl-0">, </span><span class="hl-2">&#39;&#39;</span><span class="hl-0">)));</span><br/><span class="hl-0">      }</span><br/><span class="hl-0">      </span><span class="hl-8">if</span><span class="hl-0"> (</span><span class="hl-4">dataObject</span><span class="hl-0">.</span><span class="hl-4">color</span><span class="hl-0"> === </span><span class="hl-2">&#39;&#39;</span><span class="hl-0">) {</span><br/><span class="hl-0">        </span><span class="hl-4">console</span><span class="hl-0">.</span><span class="hl-1">log</span><span class="hl-0">(</span><span class="hl-4">file</span><span class="hl-0">.</span><span class="hl-1">replace</span><span class="hl-0">(</span><span class="hl-2">&#39;.json&#39;</span><span class="hl-0">, </span><span class="hl-2">&#39;&#39;</span><span class="hl-0">));</span><br/><span class="hl-0">      }</span><br/><span class="hl-0">    });</span><br/><span class="hl-0">  }</span>
</code></pre>
<p>Debido a que se han de gestionar los colores de los ficheros durante su lsitado, se ha procedido a analizar el contenido de los mismos con <strong>JSON.parse</strong> obteniendo así el color actual que tienen establecidos los ficheros. De forma adicional, se ha colocado una condición donde si dicho campo se encuentra vacío, se muestra sin color.</p>
<p>Finalmente, se ha creado un programa <strong>index</strong> que gestionará el programa por línea de comandos. Para demostrar su uso, se van a mostrar una serie de capturas:</p>
<p>En primer lugar, se va a crear una nueva nota para el usuario <strong>prueba</strong>:</p>
<p><img src="./img/img1.png" alt="img1"></p>
<p>Como se puede observar, se muestra dos mensajes de confirmación, uno para la creación del directorio del usuario que no existía, ademas del fichero JSON.</p>
<p><img src="./img/img2.png" alt="img2"></p>
<p>En caso de volver a añadir el mismo nombre de fichero, se muestra el siguiente mensaje de error.</p>
<p><img src="./img/img3.png" alt="img3"></p>
<p>Si se intenta editar el fichero:</p>
<p><img src="./img/img4.png" alt="img4"></p>
<p>Y en caso de editar un fichero que no existe:</p>
<p><img src="./img/img5.png" alt="img5"></p>
<p>Como último ejemplo se muestra el listado de las notas:</p>
<p><img src="./img/img6.png" alt="img6"></p>

<a href="#conclusión" id="conclusión" style="color: inherit; text-decoration: none;">
  <h2>Conclusión</h2>
</a>
<p>En esta práctica, se han puesto en práctica la gestión de comandos, así como el uso de ficheros por parte de la API Síncrona de NodeJS.</p>
<p><a href="#indice">Indice</a></p>
</div></div><div class="col-4 col-menu menu-sticky-wrap menu-highlight"><nav class="tsd-navigation primary"><ul><li class="current"><a href="modules.html">Exports</a></li></ul></nav><nav class="tsd-navigation secondary menu-sticky"><ul></ul></nav></div></div></div><footer class="with-border-bottom"><div class="container"><h2>Settings</h2><p>Theme <select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></p></div></footer><div class="container tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div><script src="assets/main.js"></script></body></html>